

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Timelock Client Configuration &mdash; OSS AtlasDB develop documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/release-notes.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="OSS AtlasDB develop documentation" href="../../index.html"/>
        <link rel="up" title="External Timelock Service Configurations" href="index.html"/>
        <link rel="next" title="Cassandra Configuration" href="../cassandra_config.html"/>
        <link rel="prev" title="Timelock Server Configuration" href="timelock_server_config.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> OSS AtlasDB
          

          
          </a>

          
            
            
              <div class="version">
                develop
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schemas/index.html">Schemas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transactions/index.html">Transactions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../key_value_service_configs/index.html">Key Value Service Configurations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">External Timelock Service Configurations</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="timelock_server_config.html">Timelock Server Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Timelock Client Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra_config.html">Cassandra Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multinode_cassandra.html">Multinode Cassandra HA Guarantees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enabling_cassandra_tracing.html">Enabling Cassandra Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leader_config.html">Leader Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Logging Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timestamp_client.html">Timestamp Client Options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cluster_management/index.html">Cluster Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/index.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes/index.html">Releases</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OSS AtlasDB</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Configuration</a> &raquo;</li>
        
          <li><a href="index.html">External Timelock Service Configurations</a> &raquo;</li>
        
      <li>Timelock Client Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/palantir/atlasdb/blob/develop/docs/source/configuration/external_timelock_service_configs/timelock_client_config.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="timelock-client-configuration">
<span id="id1"></span><h1>Timelock Client Configuration<a class="headerlink" href="#timelock-client-configuration" title="Permalink to this headline">¶</a></h1>
<p>You will need to update your AtlasDB configuration in order to have said clients request timestamps and locks from
external Timelock Servers as opposed to their embedded services. This is an extension of the leader block configuration
options discussed at <a class="reference internal" href="../leader_config.html#leader-config"><span class="std std-ref">Leader Configuration</span></a>.</p>
<p>Instead of configuring a <code class="docutils literal"><span class="pre">leader</span></code> block, or both a <code class="docutils literal"><span class="pre">timestamp</span></code> and <code class="docutils literal"><span class="pre">lock</span></code> block, one must instead specify a
single <code class="docutils literal"><span class="pre">timelock</span></code> block if your product uses the Timelock Server. The <code class="docutils literal"><span class="pre">leader</span></code> block and the <code class="docutils literal"><span class="pre">timestamp</span></code>/<code class="docutils literal"><span class="pre">lock</span></code>
blocks must be absent from the config if you are using the Timelock Server.</p>
<div class="section" id="timelock">
<h2>Timelock<a class="headerlink" href="#timelock" title="Permalink to this headline">¶</a></h2>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">Changing the TimeLock <code class="docutils literal"><span class="pre">client</span></code> will mean that one receives timestamps from a different timestamp service.
This may result in <strong>SEVERE DATA CORRUPTION</strong> as the timestamp service’s guarantees may be broken.
Doing this safely requires a fast forward of the new client to at least the highest timestamp given out from the old client.
Please contact the AtlasDB team for assistance on such an operation.</p>
</div>
<p>Required parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>client</td>
<td><p class="first">The name of your client, generally the same as your application name.
Note that if the top-level AtlasDB <code class="docutils literal"><span class="pre">namespace</span></code> configuration parameter is set, then this parameter need not be set.
However, if it is, then this parameter MUST be equal to the AtlasDB <code class="docutils literal"><span class="pre">namespace</span></code>, or AtlasDB will fail to start.</p>
<p class="last">Note that client names must be non-empty and consist of only alphanumeric characters, dashes and
underscores (succinctly, <code class="docutils literal"><span class="pre">[a-zA-Z0-9_-]+</span></code>) and for backwards compatibility cannot be the reserved word <code class="docutils literal"><span class="pre">leader</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td>serversList::servers</td>
<td>A list of all hosts. The hosts must be specified as addresses, i.e. <code class="docutils literal"><span class="pre">https://host:port</span></code>.
At least one server must be specified. AtlasDB assumes that the Timelock Servers being pointed at
are part of the same Timelock cluster.</td>
</tr>
</tbody>
</table>
<p>Optional parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>serversList::sslConfiguration</td>
<td>The SSL configuration of the service. This should follow the
<a class="reference external" href="https://github.com/palantir/http-remoting/blob/develop/ssl-config/src/main/java/com/palantir/remoting2/config/ssl/SslConfiguration.java">palantir/http-remoting</a>
library. This should also be in alignment with the protocol used when configuring the servers.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="timelock-configuration-examples">
<span id="timelock-config-examples"></span><h2>Timelock Configuration Examples<a class="headerlink" href="#timelock-configuration-examples" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of an AtlasDB configuration with the <code class="docutils literal"><span class="pre">timelock</span></code> block.</p>
<p>If you are using Cassandra, then automated migration will be performed when starting up your AtlasDB clients.
If you are using another key-value-service, then you MUST ensure that you have migrated to the Timelock Server before
adding a <code class="docutils literal"><span class="pre">timelock</span></code> block to the config.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">yourapp</span>

<span class="l l-Scalar l-Scalar-Plain">atlasdb</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">keyValueService</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">cassandra</span>
    <span class="l l-Scalar l-Scalar-Plain">servers</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cassandra:9160</span>
    <span class="l l-Scalar l-Scalar-Plain">poolSize</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">20</span>
    <span class="l l-Scalar l-Scalar-Plain">credentials</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">username</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">cassandra</span>
      <span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">cassandra</span>
    <span class="l l-Scalar l-Scalar-Plain">sslConfiguration</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">trustStorePath</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">var/security/truststore.jks</span>
    <span class="l l-Scalar l-Scalar-Plain">replicationFactor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="l l-Scalar l-Scalar-Plain">mutationBatchCount</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10000</span>
    <span class="l l-Scalar l-Scalar-Plain">mutationBatchSizeBytes</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10000000</span>
    <span class="l l-Scalar l-Scalar-Plain">fetchBatchCount</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
    <span class="l l-Scalar l-Scalar-Plain">autoRefreshNodes</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

  <span class="l l-Scalar l-Scalar-Plain">timelock</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">serversList</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">servers</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">palantir-1.com:8080</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">palantir-2.com:8080</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">palantir-3.com:8080</span>
      <span class="l l-Scalar l-Scalar-Plain">sslConfiguration</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">trustStorePath</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">var/security/truststore.jks</span>
</pre></div>
</div>
<p>The example above uses the <code class="docutils literal"><span class="pre">namespace</span></code> parameter; the <code class="docutils literal"><span class="pre">client</span></code> we will use when connecting to TimeLock will be <code class="docutils literal"><span class="pre">yourapp</span></code>.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cassandra_config.html" class="btn btn-neutral float-right" title="Cassandra Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="timelock_server_config.html" class="btn btn-neutral" title="Timelock Server Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Palantir Technologies.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'develop',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>